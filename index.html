<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>Neon Jegyzet</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
  body{
    margin:0;
    background:#0a0a0a;
    color:#fff;
    font-family:Arial, sans-serif;
  }
  .container{
    display:flex;
    height:100vh;
  }
  .sidebar{
    width:60px;
    background:#111;
    padding:10px;
    box-sizing:border-box;
    overflow-y:auto;
  }
  .color-btn{
    width:100%;
    height:24px;
    margin-bottom:6px;
    border:none;
    cursor:pointer;
    outline:none;
    border-radius:4px;
    box-shadow:0 0 5px rgba(255,255,255,0.3);
  }
  .main{
    flex:1;
    padding:10px;
    box-sizing:border-box;
    display:flex;
    flex-direction:column;
  }
  .toolbar{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    margin-bottom:10px;
    align-items:center;
  }
  .toolbar select, .toolbar input, .toolbar button{
    padding:6px;
    border-radius:4px;
    border:1px solid #333;
    background:#111;
    color:#fff;
    outline:none;
  }
  #editorHeader {
    padding: 10px;
    font-size: 18px;
    min-height: 30px;
    margin-bottom: 5px;
    border-bottom: 1px dashed #333;
  }
  .editor{
    flex:1;
    background:#050505;
    border:1px solid #333;
    border-radius:6px;
    padding:10px;
    overflow-y:auto;
    font-size:18px;
    white-space: pre-wrap;
    word-wrap: break-word;
    word-break: break-word;
  }
  .editor:focus{
    outline:none;
    border-color:#555;
  }
  /* Neon Színek */
  .neon-orange{ color:#ff6600; text-shadow:0 0 5px #ff6600,0 0 10px #ff6600,0 0 15px #ff6600,0 0 20px #ff6600; }
  .neon-yellow{ color:#ffff00; text-shadow:0 0 5px #ffff00,0 0 10px #ffff00,0 0 15px #ffff00,0 0 20px #ffff00; }
  .neon-darkred{ color:#7a001f; text-shadow:0 0 5px #7a001f,0 0 10px #7a001f,0 0 15px #7a001f,0 0 20px #7a001f; }
  .neon-cyan{ color:#00f6ff; text-shadow:0 0 5px #00f6ff,0 0 10px #00f6ff,0 0 15px #00f6ff,0 0 20px #00f6ff; }
  .neon-blue{ color:#00aaff; text-shadow:0 0 5px #00aaff,0 0 10px #00aaff,0 0 15px #00aaff,0 0 20px #00aaff; }
  .neon-deepblue{ color:#0080ff; text-shadow:0 0 5px #0080ff,0 0 10px #0080ff,0 0 15px #0080ff,0 0 20px #0080ff; }
  .neon-magenta{ color:#ff00ff; text-shadow:0 0 5px #ff00ff,0 0 10px #ff00ff,0 0 15px #ff00ff,0 0 20px #ff00ff; }
  .neon-pink{ color:#ff33ff; text-shadow:0 0 5px #ff33ff,0 0 10px #ff33ff,0 0 15px #ff33ff,0 0 20px #ff33ff; }
  .neon-green{ color:#00ff00; text-shadow:0 0 5px #00ff00,0 0 10px #00ff00,0 0 15px #00ff00,0 0 20px #00ff00; }
  .neon-lightgreen{ color:#00ff66; text-shadow:0 0 5px #00ff66,0 0 10px #00ff66,0 0 15px #00ff66,0 0 20px #00ff66; }
  .neon-lime{ color:#33ff33; text-shadow:0 0 5px #33ff33,0 0 10px #33ff33,0 0 15px #33ff33,0 0 20px #33ff33; }
  .neon-mint{ color:#00ff99; text-shadow:0 0 5px #00ff99,0 0 10px #00ff99,0 0 15px #00ff99,0 0 20px #00ff99; }
  .neon-purple{ color:#8000ff; text-shadow:0 0 5px #8000ff,0 0 10px #8000ff,0 0 15px #8000ff,0 0 20px #8000ff; }
  .neon-red{ color:#ff0000; text-shadow:0 0 5px #ff0000,0 0 10px #ff0000,0 0 15px #ff0000,0 0 20px #ff0000; }
  .neon-white{ color:#ffffff; text-shadow:0 0 5px #ffffff,0 0 10px #ffffff,0 0 15px #ffffff,0 0 20px #ffffff; }

  /* Glow-off kényszerítése */
  .glow-off [class^='neon-'] { text-shadow: none !important; }

  #glowBtn.on { background: #00ff00 !important; color: #000 !important; font-weight: bold; }
  #glowBtn.off { background: #ff0000 !important; color: #fff !important; font-weight: bold; }

  .saved-panel{ width:300px; background:#222; padding:20px; box-sizing:border-box; display: flex; flex-direction: column; overflow-y:auto; }
  .saved-panel h3{ color:#00f6ff; margin-top:0; }
  #savedList { flex: 1; overflow-y: auto; }
  .saved-item{ border-bottom:1px solid #333; padding:6px; cursor:pointer; }
  .saved-item:hover{ background:#111; }
  .editor a { text-decoration: underline; cursor: pointer; color: inherit; }
</style>
</head>
<body class="">

<div class="container">
  <div class="sidebar">
    <div style="text-align:center;font-size:12px;margin-bottom:8px;">Neon<br>Színek</div>
    <button class="color-btn" style="background:#ff6600" onmousedown="applyColorAndSet(event, 'neon-orange')"></button>
    <button class="color-btn" style="background:#ffff00" onmousedown="applyColorAndSet(event, 'neon-yellow')"></button>
    <button class="color-btn" style="background:#7a001f" onmousedown="applyColorAndSet(event, 'neon-darkred')"></button>
    <button class="color-btn" style="background:#00f6ff" onmousedown="applyColorAndSet(event, 'neon-cyan')"></button>
    <button class="color-btn" style="background:#00aaff" onmousedown="applyColorAndSet(event, 'neon-blue')"></button>
    <button class="color-btn" style="background:#0080ff" onmousedown="applyColorAndSet(event, 'neon-deepblue')"></button>
    <button class="color-btn" style="background:#ff00ff" onmousedown="applyColorAndSet(event, 'neon-magenta')"></button>
    <button class="color-btn" style="background:#ff33ff" onmousedown="applyColorAndSet(event, 'neon-pink')"></button>
    <button class="color-btn" style="background:#00ff00" onmousedown="applyColorAndSet(event, 'neon-green')"></button>
    <button class="color-btn" style="background:#00ff66" onmousedown="applyColorAndSet(event, 'neon-lightgreen')"></button>
    <button class="color-btn" style="background:#33ff33" onmousedown="applyColorAndSet(event, 'neon-lime')"></button>
    <button class="color-btn" style="background:#00ff99" onmousedown="applyColorAndSet(event, 'neon-mint')"></button>
    <button class="color-btn" style="background:#8000ff" onmousedown="applyColorAndSet(event, 'neon-purple')"></button>
    <button class="color-btn" style="background:#ff0000" onmousedown="applyColorAndSet(event, 'neon-red')"></button>
    <button class="color-btn" style="background:#ffffff" onmousedown="applyColorAndSet(event, 'neon-white')"></button>
  </div>

  <div class="main">
    <div class="toolbar">
      <label>Betűtípus:</label>
      <select id="fontSelect" onchange="setFont()">
        <option value="Arial">Arial (Alap)</option>
        <option value="Courier New">Courier New (Írógép)</option>
        <option value="Impact">Impact (Vastag)</option>
        <option value="Georgia">Georgia (Elegáns)</option>
        <option value="Comic Sans MS">Comic Sans (Játékos)</option>
        <option value="Verdana">Verdana (Tiszta)</option>
        <option value="Tahoma">Tahoma (Modern)</option>
        <option value="Trebuchet MS">Trebuchet MS (Szép)</option>
        <option value="Lucida Console">Lucida Console (Monospace)</option>
        <option value="Lucida Sans">Lucida Sans (Klasszikus)</option>
        <option value="Palatino Linotype">Palatino (Elegáns)</option>
        <option value="Garamond">Garamond (Régi stílus)</option>
        <option value="Bookman">Bookman (Klasszikus)</option>
        <option value="Century Gothic">Century Gothic (Modern)</option>
        <option value="Arial Black">Arial Black (Vastag)</option>
        <option value="Brush Script MT">Brush Script (Kézírás)</option>
        <option value="Segoe UI">Segoe UI (Windows)</option>
        <option value="Roboto">Roboto (Modern)</option>
        <option value="Open Sans">Open Sans (Letisztult)</option>
        <option value="Lato">Lato (Modern)</option>
        <option value="Montserrat">Montserrat (Modern)</option>
        <option value="Oswald">Oswald (Erős)</option>
        <option value="Poppins">Poppins (Letisztult)</option>
        <option value="Playfair Display">Playfair Display (Elegáns)</option>
        <option value="Pacifico">Pacifico (Kézírás)</option>
        <option value="Great Vibes">Great Vibes (Kézírás)</option>
        <option value="Orbitron">Orbitron (Sci-fi)</option>
        <option value="Press Start 2P">Press Start 2P (Retro)</option>
        <option value="Roboto Mono">Roboto Mono (Monospace)</option>
      </select>

      <label>Betűméret:</label>
      <input type="range" id="sizeRange" min="8" max="100" value="18" oninput="setSize(this.value)">
      <span id="sizeValue">18</span>px

      <button onclick="resetColor()">Reset szín</button>
      <button id="glowBtn" class="on" onclick="toggleGlow()">Glow ON</button>
      <input type="text" id="linkInput" placeholder="Link beillesztése..." />
      <button onclick="insertLink()">Link beillesztése a jegyzetbe</button>
      <button onclick="newNote()">Új jegyzet</button>
    </div>

    <div class="toolbar">
        <button onclick="loadNote()">Jegyzet betöltés</button>
        <button onclick="saveNote()">Mentés</button>
        <button onclick="deleteNote()">Törlés</button>
        <button onclick="exportNotes()">Export (JSON)</button>
        <button onclick="importNotes()">Import (JSON)</button>
        <button onclick="downloadPNG(false)">PNG fekete háttér</button>
        <button onclick="downloadPNG(true)">PNG átlátszó</button>
    </div>

    <div id="savePath" style="margin-top:6px; font-size:14px; font-family: 'Courier New', monospace;"></div>
    <div id="editorHeader"></div>
    <div id="editor" class="editor" contenteditable="true"></div>
  </div>

  <div class="saved-panel">
    <h3>Mentett jegyzetek</h3>
    <div id="savedList"></div>
    <button class="clear-btn" onclick="clearList()" style="background:#7a001f; color:white; border:1px solid red; padding:10px; cursor:pointer;">Lista ürítése</button>
  </div>
</div>

<script>
  const editor = document.getElementById("editor");
  const editorHeader = document.getElementById("editorHeader");
  const savedList = document.getElementById("savedList");
  const savePath = document.getElementById("savePath");
  const linkInput = document.getElementById("linkInput");
  const glowBtn = document.getElementById("glowBtn");
  let activeColorClass = "neon-white";
  let glowOn = true;
  let notes = [];

  window.onload = () => {
    const savedData = localStorage.getItem("neonNotes_Final");
    if (savedData) {
      notes = JSON.parse(savedData);
      notes.forEach(n => addSavedItemToUI(n.name, n.timestamp, n.color));
    }
    editor.focus();
  };

  function toggleGlow(){
    glowOn = !glowOn;
    if(glowOn) {
      document.body.classList.remove("glow-off");
      glowBtn.innerText = "Glow ON";
      glowBtn.className = "on";
    } else {
      document.body.classList.add("glow-off");
      glowBtn.innerText = "Glow OFF";
      glowBtn.className = "off";
    }
    editor.focus();
  }

  function applyColorAndSet(e, className) {
    e.preventDefault();
    activeColorClass = className;
    const selection = window.getSelection();
    if (selection.rangeCount > 0 && selection.toString().length > 0) {
      const span = `<span class="${className}">${selection.toString()}</span>`;
      document.execCommand("insertHTML", false, span);
    }
    editor.focus();
  }

  function resetColor(){ activeColorClass = "neon-white"; editor.focus(); }
  function setFont(){ editor.style.fontFamily = document.getElementById("fontSelect").value; editor.focus(); }
  function setSize(size){ editor.style.fontSize = size + "px"; document.getElementById("sizeValue").innerText = size; editor.focus(); }

  function insertHTMLAtCursor(html){
    const sel=window.getSelection();
    if(!sel.rangeCount) return;
    const range=sel.getRangeAt(0);
    range.deleteContents();
    const el=document.createElement("div");
    el.innerHTML=html;
    const frag=document.createDocumentFragment();
    let node,lastNode;
    while((node=el.firstChild)) lastNode=frag.appendChild(node);
    range.insertNode(frag);
    if(lastNode){
      range.setStartAfter(lastNode);
      range.collapse(true);
      sel.removeAllRanges();
      sel.addRange(range);
    }
  }

  editor.addEventListener("keydown", e => {
    if(e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey){
      e.preventDefault();
      let char = e.key === " " ? "&nbsp;" : e.key;
      insertHTMLAtCursor(`<span class="${activeColorClass}">${char}</span>`);
    } else if(e.key === "Enter"){
      e.preventDefault();
      insertHTMLAtCursor("<div><br></div>");
    }
  });

  editor.addEventListener("paste", e => {
    e.preventDefault();
    const text = (e.clipboardData || window.clipboardData).getData("text");
    let html = "";
    for(let char of text){
      if(char === "\n") html += "<div><br></div>";
      else if(char === " ") html += "&nbsp;";
      else html += `<span class="${activeColorClass}">${char}</span>`;
    }
    insertHTMLAtCursor(html);
  });

  function insertLink(){
    let url = linkInput.value.trim();
    if(url) {
        if(!url.startsWith("http")) url = "https://" + url;
        const linkHTML = `<a href="${url}" target="_blank" class="${activeColorClass}">${url}</a><span>&nbsp;</span>`;
        insertHTMLAtCursor(linkHTML);
        linkInput.value = "";
    }
  }

  function getFormattedDate() {
    const d = new Date();
    return `${d.getFullYear()}.${String(d.getMonth()+1).padStart(2,'0')}.${String(d.getDate()).padStart(2,'0')}_${String(d.getHours()).padStart(2,'0')}-${String(d.getMinutes()).padStart(2,'0')}`;
  }

  function saveNote(){
    const intro = prompt("Bevezető:"); if(intro===null) return;
    const name = prompt("Jegyzet neve:"); if(!name) return;
    const timestamp = new Date().toLocaleString();
    editorHeader.innerHTML = `<span class="${activeColorClass}">${intro} - ${name} - ${timestamp}</span>`;
    const data = { name, intro, timestamp, content: editor.innerHTML, color: activeColorClass };
    notes.push(data);
    localStorage.setItem("neonNotes_Final", JSON.stringify(notes));
    const fileName = `Jegyzetek_${name}_${getFormattedDate()}.json`;
    const a = document.createElement("a");
    a.href = URL.createObjectURL(new Blob([JSON.stringify(data)], { type: 'application/json' }));
    a.download = fileName;
    a.click();
    addSavedItemToUI(name, timestamp, activeColorClass);
    savePath.innerHTML = `<span style="color:#00ff00">Mentés helye:</span> <span style="color:#ffff00">Böngésző letöltési mappa</span><br><span style="color:#00ff00">Utolsó mentés:</span> <span style="color:#00ff00">${fileName}</span><br><span style="color:#00ff00">Időpont:</span> <span style="color:#00f6ff">${timestamp}</span>`;
  }

  function addSavedItemToUI(name, date, color){
    const div = document.createElement("div"); div.className="saved-item";
    div.innerHTML=`<span class="${color}">${name} - ${date}</span>`;
    div.onclick = ()=>{ 
      const found = notes.find(n=>n.name===name && n.timestamp===date);
      if(found) { editor.innerHTML = found.content; editorHeader.innerHTML = `<span class="${found.color}">${found.intro} - ${found.name} - ${found.timestamp}</span>`; }
    };
    savedList.appendChild(div);
  }

  function loadNote(){
      const name = prompt("Betöltendő név:");
      const found = notes.find(n=>n.name === name);
      if(found) { editor.innerHTML = found.content; editorHeader.innerHTML = `<span class="${found.color}">${found.intro} - ${found.name} - ${found.timestamp}</span>`; }
  }

  function exportNotes(){
    const exportName = prompt("Export fájl neve:"); if(!exportName) return;
    const a = document.createElement("a");
    a.href = URL.createObjectURL(new Blob([JSON.stringify(notes)], {type:'application/json'}));
    a.download = `Jegyzetek_Export_${exportName}_${getFormattedDate()}.json`;
    a.click();
  }

  function importNotes(){
    const i = document.createElement("input"); i.type="file";
    i.onchange = e => {
      const r = new FileReader();
      r.onload = ev => {
        const data = JSON.parse(ev.target.result);
        if(Array.isArray(data)) notes = notes.concat(data); else notes.push(data);
        localStorage.setItem("neonNotes_Final", JSON.stringify(notes));
        location.reload();
      };
      r.readAsText(e.target.files[0]);
    };
    i.click();
  }

  function downloadPNG(transparent){
    const originalBG = editor.style.background;
    if(transparent) editor.style.background = "transparent";
    html2canvas(editor, { backgroundColor: transparent ? null : "#000", scale: 2 }).then(canvas => {
      const a = document.createElement("a");
      a.download = `jegyzet_${Date.now()}.png`;
      a.href = canvas.toDataURL();
      a.click();
      editor.style.background = originalBG;
    });
  }
  function newNote(){ editor.innerHTML = ""; editorHeader.innerHTML = ""; savePath.innerHTML = ""; }
  function deleteNote(){ newNote(); }
  function clearList() { if(confirm("Törlés?")) { notes=[]; localStorage.removeItem("neonNotes_Final"); savedList.innerHTML=""; } }
</script>
</body>
</html>
